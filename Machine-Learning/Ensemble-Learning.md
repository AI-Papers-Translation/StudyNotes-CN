# [机器学习--集成学习（Ensemble Learning）](https://www.cnblogs.com/zongfa/p/9304353.html)

## 集成学习法

在机器学习的有监督学习算法中，目标是学习出一个稳定的，并且在各个方面都表现较好的模型，但实际情况只能得到多个有偏好的模型（弱监督模型，在某些方面表现的比较好）。集成学习就是组合得到的多个弱监督模型以期得到一个更好更全面的强监督模型。集成学习潜在的思想是即使某一个弱分类器得到了错误的预测，其他的弱分类器也可以将错误纠正回来。

集成方法是将几种机器学习技术组合成一个预测模型的元算法，以达到减小方差（bagging）、偏差（boosting）或改进预测（stacking）的效果。

集成学习在各个规模的数据集上都有很好的策略。

-   数据集大：划分成多个小数据集，学习多个模型进行组合
-   数据集小：利用Bootstrap方法进行抽样，得到多个数据集，分别训练多个模型再进行组合

集合方法可分为两类：

-   序列集成方法，其中参与训练的基础学习器按照顺序生成（例如 AdaBoost）。序列方法的原理是利用基础学习器之间的依赖关系。通过对之前训练中错误标记的样本赋值较高的权重，可以提高整体的预测效果。
-   并行集成方法，其中参与训练的基础学习器并行生成（例如 Random Forest）。并行方法的原理是利用基础学习器之间的独立性，通过平均可以显著降低错误。

集成学习的特点：

1.  多个分类方法聚集在一起，以提高分类的准确率。

    （这些算法可以是不同的算法，也可以是相同的算法。）

2.  集成学习法由训练数据构建一组基分类器，然后通过对每个基分类器的预测进行投票来进行分类

3.  严格来说，集成学习并不算是一种分类器，而是一种分类器结合的方法。

4.  通常一个集成分类器的分类性能会好于单个分类器

5.  如果把单个分类器比作一个决策者的话，集成学习的方法就相当于多个决策者共同进行一项决策。

集成学习的问题：

1.  怎么训练每个算法？
2.  怎么融合每个算法？

常用的集成学习方法：

-   Bagging：Random Forest
-   Boosting : AdaBoost, GBDT
-   Stacking : Logistic Regression

### Bagging

Bagging（bootstrap aggregating）即套袋法。

先说一下bootstrap，bootstrap也称为自助法，它是一种有放回的抽样方法，目的为了得到统计量的分布以及置信区间，其算法过程如下：

1.  从原始样本集中抽取训练集。每轮从原始样本集中使用Bootstraping的方法抽取n个训练样本（在训练集中，有些样本可能被多次抽取到，而有些样本可能一次都没有被抽中）。共进行k轮抽取，得到k个训练集。（k个训练集之间是相互独立的）
2.  每次使用一个训练集得到一个模型，k个训练集共得到k个模型。（注：这里并没有具体的分类算法或回归方法，我们可以根据具体问题采用不同的分类或回归方法，如决策树、感知器等）
3.  对分类问题：将上步得到的k个模型采用投票的方式得到分类结果；对回归问题，计算上述模型的均值作为最后的结果。（所有模型的重要性相同）

　　![img](https://images2018.cnblogs.com/blog/1180120/201807/1180120-20180713122517325-458611743.png)

理解 Bagging 的例子：

-   X 表示一维属性，Y 表示类标号（1或-1）测试条件：当x<=k时，y=？；当x>k时，y=？；k为最佳分裂点
-   下表为属性x对应的唯一正确的y类别
-   现在进行5轮随机抽样，结果如下

　　![img](https://images2018.cnblogs.com/blog/1180120/201807/1180120-20180713115759392-1600688523.png)

　　![img](https://images2018.cnblogs.com/blog/1180120/201807/1180120-20180713115811824-449876825.png)

-　每一轮随机抽样后，都生成一个分类器

-　然后再将五轮分类融合

　　![img](https://images2018.cnblogs.com/blog/1180120/201807/1180120-20180713120026299-340122631.png)

-　对比符号和实际类，我们可以发现：在该例子中，Bagging使得准确率可达90%

Bagging 方法的特点：

1.  Bagging通过降低基分类器的方差，改善了泛化误差
2.  其性能依赖于基分类器的稳定性；
    -   如果基分类器不稳定，bagging有助于降低训练数据的随机波动导致的误差；
    -   如果基分类器稳定，则集成分类器的误差主要由基分类器的偏置引起
3.  由于每个样本被选中的概率相同，因此bagging并不侧重于训练数据集中的任何特定实例

常用的 Bagging 类算法是随机森林。在随机森林中，集成中的每棵树都是由从训练集中抽取的样本（即 bootstrap 样本）构建的。另外，与使用所有特征不同，这里随机选择特征子集，从而进一步达到对树的随机化目的。因此，随机森林产生的偏差略有增加，但是由于对相关性较小的树计算平均值，估计方差减小了，导致模型的整体效果更好。

　　![img](https://images2018.cnblogs.com/blog/1180120/201807/1180120-20180713123844679-346592925.png)

### Boosting

其主要思想是将弱分类器组装成一个强分类器。在PAC（probably approximately correct，概率近似正确）学习框架下，则一定可以将弱分类器组装成一个强分类器。

关于Boosting的两个核心问题：

1.  在每一轮如何改变训练数据的权值或概率分布？

    提高那些在前一轮被弱分类器分错样例的权值，减小前一轮分对样例的权值，使得分类器对误分的数据有较好的效果。

2.  通过什么方式来组合弱分类器？

    通过加法模型将弱分类器进行线性组合，比如：
    
    -   **AdaBoost**（Adaptive boosting）算法：刚开始训练时对每一个训练例赋相等的权重，然后用该算法对训练集训练t轮，每次训练后，对训练失败的训练例赋以较大的权重，也就是让学习算法在每次学习以后更注意学错的样本，从而得到多个预测函数。通过拟合残差的方式逐步减小残差，将每一步生成的模型叠加得到最终模型。
    -   **GBDT**（Gradient Boost Decision Tree)，每一次的计算是为了减少上一次的残差，GBDT在残差减少（负梯度）的方向上建立一个新的模型。

　　![img](https://images2018.cnblogs.com/blog/1180120/201807/1180120-20180713122552774-1172049695.png)

### Stacking

Stacking方法是指训练一个模型用于组合其他各个模型。首先我们先训练多个不同的模型，然后把之前训练的各个模型的输出为输入来训练一个模型，以得到一个最终的输出。理论上，Stacking可以表示上面提到的两种集成方法，只要采用合适的模型组合策略即可。但在实际中，通常使用logistic回归作为组合策略。如下图，先在整个训练数据集上通过bootstrap抽样得到各个训练集合，得到一系列分类模型，然后将输出用于训练第二层分类器。

　　![img](https://images2018.cnblogs.com/blog/1180120/201807/1180120-20180713122631208-191903753.png)

## 算法之间的联系与区别

1.  Bagging和Boosting的区别：
    -   样本选择上：
        -   Bagging：训练集是在原始集中有放回选取的，从原始集中选出的各轮训练集之间是独立的。
        -   Boosting：每一轮的训练集不变，只是训练集中每个样例在分类器中的权重发生变化。而权值是根据上一轮的分类结果进行调整。
    -   样例权重：
        -   Bagging：使用均匀取样，每个样例的权重相等
        -   Boosting：根据错误率不断调整样例的权值，错误率越大则权重越大。
    -   预测函数：
        -   Bagging：所有预测函数的权重相等。
        -   Boosting：每个弱分类器都有相应的权重，对于分类误差小的分类器会有更大的权重。
    -   并行计算：
        -   Bagging：各个预测函数可以并行生成
        -   Boosting：各个预测函数只能顺序生成，因为后一个模型参数需要前一轮模型的结果。

2.  决策树与这些算法框架进行结合所得到的新的算法：
    -   Bagging + 决策树 = 随机森林
    -   AdaBoost + 决策树 = 提升树
    -   Gradient Boosting + 决策树 = GBDT

参考博文：

【1】[集成学习总结 & Stacking方法详解](https://blog.csdn.net/willduan1/article/details/73618677)

【2】[Bagging和Boosting 概念及区别](https://www.cnblogs.com/liuwu265/p/4690486.html)

【3】[集成学习法之bagging方法和boosting方法](https://blog.csdn.net/qq_30189255/article/details/51532442)

【4】[机器学习中的集成学习（Ensemble Learning)](http://baijiahao.baidu.com/s?id=1590266955499942419&wfr=spider&for=pc)

【5】[简单易学的机器学习算法——集成方法(Ensemble Method)](https://blog.csdn.net/google19890102/article/details/46507387)
